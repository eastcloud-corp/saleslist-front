(()=>{var e={};e.id=662,e.ids=[662],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1319:(e,s,t)=>{Promise.resolve().then(t.bind(t,8041))},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},5336:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(2688).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},5544:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>l.a,__next_app__:()=>u,pages:()=>o,routeModule:()=>m,tree:()=>c});var a=t(5239),r=t(8088),n=t(8170),l=t.n(n),i=t(893),d={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);t.d(s,d);let c={children:["",{children:["settings",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,8245)),"/app/app/settings/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,8014)),"/app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,7398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,5284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,o=["/app/app/settings/page.tsx"],u={require:t,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:r.RouteKind.APP_PAGE,page:"/settings/page",pathname:"/settings",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},5616:(e,s,t)=>{"use strict";t.d(s,{T:()=>n});var a=t(687);t(3210);var r=t(6241);function n({className:e,...s}){return(0,a.jsx)("textarea",{"data-slot":"textarea",className:(0,r.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...s})}},6895:(e,s,t)=>{Promise.resolve().then(t.bind(t,8245))},8041:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>ey});var a=t(687),r=t(2571),n=t(5192),l=t(5910),i=t(3210),d=t(4934),c=t(7826),o=t(8988),u=t(9390),m=t(3974),x=t(5616),h=t(2688);let p=(0,h.A)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var j=t(5336);let v=(0,h.A)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);var g=t(7163);function f(){let[e,s]=(0,i.useState)([]),[t,a]=(0,i.useState)(!1),[r,n]=(0,i.useState)(null),l=async()=>{try{a(!0),n(null);let e=await g.uE.get("/auth/users/");if(e.ok){let t=await e.json();s(t.results||[])}else throw Error("ユーザー一覧の取得に失敗しました")}catch(e){n("ユーザー一覧の取得に失敗しました"),s([])}finally{a(!1)}},d=async e=>{try{return a(!0),n(null),await g.uE.post("/auth/users/create/",{name:e.email.split("@")[0],email:e.email,role:e.role,password:"temp123"}),await l(),{success:!0,message:"ユーザー招待を送信しました"}}catch(s){let e="ユーザー招待の送信に失敗しました";return n(e),{success:!1,message:e}}finally{a(!1)}},c=async(e,s)=>{try{return a(!0),n(null),await g.uE.patch(`/auth/users/${e}/`,{role:s}),await l(),{success:!0,message:"ユーザー権限を更新しました"}}catch(s){let e="ユーザー権限の更新に失敗しました";return n(e),{success:!1,message:e}}finally{a(!1)}},o=async(e,s)=>{try{return a(!0),n(null),await g.uE.patch(`/auth/users/${e}/`,{is_active:s}),await l(),{success:!0,message:`ユーザーを${s?"有効化":"無効化"}しました`}}catch(t){let e=`ユーザーの${s?"有効化":"無効化"}に失敗しました`;return n(e),{success:!1,message:e}}finally{a(!1)}},u=async e=>await o(e,!1);return{users:e,loading:t,error:r,fetchUsers:l,refetch:l,inviteUser:d,updateUserRole:c,updateUserStatus:o,deactivateUser:u}}var y=t(3193),b=t(638);function N({onUserCreated:e}){let[s,t]=(0,i.useState)(!1),[r,n]=(0,i.useState)(""),[l,h]=(0,i.useState)(""),[g,N]=(0,i.useState)(""),[w,_]=(0,i.useState)("user"),[C,A]=(0,i.useState)(""),[k,$]=(0,i.useState)(null),[S,F]=(0,i.useState)(null),[D,P]=(0,i.useState)(!1),{inviteUser:J,loading:E}=f(),R=async()=>{if(S){let e=`メールアドレス: ${S.email}
パスワード: ${S.password}`;await navigator.clipboard.writeText(e),P(!0),setTimeout(()=>P(!1),2e3)}},M=async s=>{if(s.preventDefault(),$(null),!r){$("メールアドレスを入力してください");return}if(!g){$("パスワードを入力してください");return}let t=await J({email:r,password:g,role:w,message:C||void 0});t.success?(F({email:r,password:g}),e&&e()):$(t.message)};return(0,a.jsxs)(c.lG,{open:s,onOpenChange:e=>{t(e),e||(n(""),N(""),_("user"),A(""),F(null),P(!1),$(null))},children:[(0,a.jsx)(c.zM,{asChild:!0,children:(0,a.jsxs)(d.$,{children:[(0,a.jsx)(p,{className:"mr-2 h-4 w-4"}),"ユーザー作成"]})}),(0,a.jsxs)(c.Cf,{className:"sm:max-w-[425px]",children:[(0,a.jsxs)(c.c7,{children:[(0,a.jsx)(c.L3,{children:S?"ユーザー作成完了":"新規ユーザー作成"}),(0,a.jsx)(c.rr,{children:S?"ユーザーが作成されました。以下の認証情報を別ツールで共有してください。":"新しいユーザーを作成します。認証情報は別ツールで共有してください。"})]}),S?(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"p-4 bg-muted rounded-lg space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(u.J,{className:"text-sm font-medium",children:"メールアドレス"}),(0,a.jsx)("p",{className:"font-mono text-sm mt-1",children:S.email})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(u.J,{className:"text-sm font-medium",children:"パスワード"}),(0,a.jsx)("p",{className:"font-mono text-sm mt-1",children:S.password})]})]}),(0,a.jsx)(d.$,{onClick:R,className:"w-full bg-transparent",variant:"outline",children:D?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(j.A,{className:"mr-2 h-4 w-4"}),"コピー完了"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(v,{className:"mr-2 h-4 w-4"}),"認証情報をコピー"]})}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"この認証情報を安全な方法でユーザーに共有してください。"})]}):(0,a.jsxs)("form",{onSubmit:M,children:[(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(u.J,{htmlFor:"email",children:"メールアドレス *"}),(0,a.jsx)(o.p,{id:"email",type:"email",value:r,onChange:e=>n(e.target.value),placeholder:"admin@your-company.com",required:!0})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(u.J,{htmlFor:"username",children:"ユーザー名 *"}),(0,a.jsx)(o.p,{id:"username",type:"text",value:l,onChange:e=>h(e.target.value),placeholder:"ユーザー名を入力",required:!0})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(u.J,{htmlFor:"password",children:"パスワード *"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(o.p,{id:"password",type:"text",value:g,onChange:e=>N(e.target.value),placeholder:"パスワードを入力または生成",required:!0}),(0,a.jsx)(d.$,{type:"button",variant:"outline",onClick:()=>{let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*",s="";for(let t=0;t<12;t++)s+=e.charAt(Math.floor(Math.random()*e.length));N(s)},children:"生成"})]})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(u.J,{htmlFor:"role",children:"権限"}),(0,a.jsxs)(m.l6,{value:w,onValueChange:e=>_(e),children:[(0,a.jsx)(m.bq,{children:(0,a.jsx)(m.yv,{})}),(0,a.jsxs)(m.gC,{children:[(0,a.jsx)(m.eb,{value:"viewer",children:"閲覧者 - データの閲覧のみ"}),(0,a.jsx)(m.eb,{value:"user",children:"一般ユーザー - データの編集可能"}),(0,a.jsx)(m.eb,{value:"admin",children:"管理者 - 全ての操作が可能"})]})]})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(u.J,{htmlFor:"message",children:"メモ（任意）"}),(0,a.jsx)(x.T,{id:"message",value:C,onChange:e=>A(e.target.value),placeholder:"ユーザーに関するメモや追加情報",rows:3})]}),k&&(0,a.jsx)(b.$,{message:k})]}),(0,a.jsxs)(c.Es,{children:[(0,a.jsx)(d.$,{type:"button",variant:"outline",onClick:()=>t(!1),children:"キャンセル"}),(0,a.jsxs)(d.$,{type:"submit",disabled:E,children:[E&&(0,a.jsx)(y.k,{className:"mr-2 h-4 w-4"}),"ユーザー作成"]})]})]}),S&&(0,a.jsx)(c.Es,{children:(0,a.jsx)(d.$,{onClick:()=>t(!1),children:"閉じる"})})]})]})}var w=t(6752),_=t(9821),C=t(8302);function A(e,s){if("function"==typeof e)return e(s);null!=e&&(e.current=s)}function k(...e){return i.useCallback(function(...e){return s=>{let t=!1,a=e.map(e=>{let a=A(e,s);return t||"function"!=typeof a||(t=!0),a});if(t)return()=>{for(let s=0;s<a.length;s++){let t=a[s];"function"==typeof t?t():A(e[s],null)}}}}(...e),e)}var $=t(146),S=!!("undefined"!=typeof window&&window.document&&window.document.createElement),F=t(1329),D="AlertDialog",[P,J]=function(e,s=[]){let t=[],r=()=>{let s=t.map(e=>i.createContext(e));return function(t){let a=t?.[e]||s;return i.useMemo(()=>({[`__scope${e}`]:{...t,[e]:a}}),[t,a])}};return r.scopeName=e,[function(s,r){let n=i.createContext(r),l=t.length;t=[...t,r];let d=s=>{let{scope:t,children:r,...d}=s,c=t?.[e]?.[l]||n,o=i.useMemo(()=>d,Object.values(d));return(0,a.jsx)(c.Provider,{value:o,children:r})};return d.displayName=s+"Provider",[d,function(t,a){let d=a?.[e]?.[l]||n,c=i.useContext(d);if(c)return c;if(void 0!==r)return r;throw Error(`\`${t}\` must be used within \`${s}\``)}]},function(...e){let s=e[0];if(1===e.length)return s;let t=()=>{let t=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let a=t.reduce((s,{useScope:t,scopeName:a})=>{let r=t(e)[`__scope${a}`];return{...s,...r}},{});return i.useMemo(()=>({[`__scope${s.scopeName}`]:a}),[a])}};return t.scopeName=s.scopeName,t}(r,...s)]}(D,[$.Hs]),E=(0,$.Hs)(),R=e=>{let{__scopeAlertDialog:s,...t}=e,r=E(s);return(0,a.jsx)($.bL,{...r,...t,modal:!0})};R.displayName=D,i.forwardRef((e,s)=>{let{__scopeAlertDialog:t,...r}=e,n=E(t);return(0,a.jsx)($.l9,{...n,...r,ref:s})}).displayName="AlertDialogTrigger";var M=e=>{let{__scopeAlertDialog:s,...t}=e,r=E(s);return(0,a.jsx)($.ZL,{...r,...t})};M.displayName="AlertDialogPortal";var q=i.forwardRef((e,s)=>{let{__scopeAlertDialog:t,...r}=e,n=E(t);return(0,a.jsx)($.hJ,{...n,...r,ref:s})});q.displayName="AlertDialogOverlay";var T="AlertDialogContent",[z,O]=P(T),B=(0,F.Dc)("AlertDialogContent"),V=i.forwardRef((e,s)=>{let{__scopeAlertDialog:t,children:r,...n}=e,l=E(t),d=i.useRef(null),c=k(s,d),o=i.useRef(null);return(0,a.jsx)($.G$,{contentName:T,titleName:Z,docsSlug:"alert-dialog",children:(0,a.jsx)(z,{scope:t,cancelRef:o,children:(0,a.jsxs)($.UC,{role:"alertdialog",...l,...n,ref:c,onOpenAutoFocus:function(e,s,{checkForDefaultPrevented:t=!0}={}){return function(a){if(e?.(a),!1===t||!a.defaultPrevented)return s?.(a)}}(n.onOpenAutoFocus,e=>{e.preventDefault(),o.current?.focus({preventScroll:!0})}),onPointerDownOutside:e=>e.preventDefault(),onInteractOutside:e=>e.preventDefault(),children:[(0,a.jsx)(B,{children:r}),(0,a.jsx)(Y,{contentRef:d})]})})})});V.displayName=T;var Z="AlertDialogTitle",I=i.forwardRef((e,s)=>{let{__scopeAlertDialog:t,...r}=e,n=E(t);return(0,a.jsx)($.hE,{...n,...r,ref:s})});I.displayName=Z;var H="AlertDialogDescription",G=i.forwardRef((e,s)=>{let{__scopeAlertDialog:t,...r}=e,n=E(t);return(0,a.jsx)($.VY,{...n,...r,ref:s})});G.displayName=H;var L=i.forwardRef((e,s)=>{let{__scopeAlertDialog:t,...r}=e,n=E(t);return(0,a.jsx)($.bm,{...n,...r,ref:s})});L.displayName="AlertDialogAction";var U="AlertDialogCancel",X=i.forwardRef((e,s)=>{let{__scopeAlertDialog:t,...r}=e,{cancelRef:n}=O(U,t),l=E(t),i=k(s,n);return(0,a.jsx)($.bm,{...l,...r,ref:i})});X.displayName=U;var Y=({contentRef:e})=>{let s=`\`${T}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${T}\` by passing a \`${H}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${T}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return i.useEffect(()=>{document.getElementById(e.current?.getAttribute("aria-describedby"))},[s,e]),null},W=t(6241);function K({...e}){return(0,a.jsx)(R,{"data-slot":"alert-dialog",...e})}function Q({...e}){return(0,a.jsx)(M,{"data-slot":"alert-dialog-portal",...e})}function ee({className:e,...s}){return(0,a.jsx)(q,{"data-slot":"alert-dialog-overlay",className:(0,W.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...s})}function es({className:e,...s}){return(0,a.jsxs)(Q,{children:[(0,a.jsx)(ee,{}),(0,a.jsx)(V,{"data-slot":"alert-dialog-content",className:(0,W.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...s})]})}function et({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"alert-dialog-header",className:(0,W.cn)("flex flex-col gap-2 text-center sm:text-left",e),...s})}function ea({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"alert-dialog-footer",className:(0,W.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...s})}function er({className:e,...s}){return(0,a.jsx)(I,{"data-slot":"alert-dialog-title",className:(0,W.cn)("text-lg font-semibold",e),...s})}function en({className:e,...s}){return(0,a.jsx)(G,{"data-slot":"alert-dialog-description",className:(0,W.cn)("text-muted-foreground text-sm",e),...s})}function el({className:e,...s}){return(0,a.jsx)(L,{className:(0,W.cn)((0,d.r)(),e),...s})}function ei({className:e,...s}){return(0,a.jsx)(X,{className:(0,W.cn)((0,d.r)({variant:"outline"}),e),...s})}function ed({open:e,onOpenChange:s,title:t,description:r,confirmText:n="Confirm",cancelText:l="Cancel",onConfirm:i,variant:d="default"}){return(0,a.jsx)(K,{open:e,onOpenChange:s,children:(0,a.jsxs)(es,{children:[(0,a.jsxs)(et,{children:[(0,a.jsx)(er,{children:t}),(0,a.jsx)(en,{children:r})]}),(0,a.jsxs)(ea,{children:[(0,a.jsx)(ei,{children:l}),(0,a.jsx)(el,{onClick:i,className:"destructive"===d?"bg-destructive text-destructive-foreground hover:bg-destructive/90":"",children:n})]})]})})}var ec=t(1702);function eo({users:e,onUserUpdated:s}){let{updateUserRole:t,updateUserStatus:r,loading:n}=f(),[l,d]=(0,i.useState)(null),[c,o]=(0,i.useState)(null),{toast:u}=(0,ec.dj)(),x=async(e,a)=>{try{await t(e,a),u({title:"成功",description:"ユーザー権限を更新しました"}),s&&s()}catch(e){u({title:"エラー",description:"権限の更新に失敗しました",variant:"destructive"})}},h=async(e,s)=>{d(e),o(s?"activate":"deactivate")},p=async()=>{if(l)try{let e=await r(l,"activate"===c);e.success?(u({title:"成功",description:e.message}),s&&s()):u({title:"エラー",description:e.message,variant:"destructive"})}catch(e){u({title:"エラー",description:`ユーザーの${"activate"===c?"有効化":"無効化"}に失敗しました`,variant:"destructive"})}finally{d(null),o(null)}},j=e=>new Date(e).toLocaleDateString("ja-JP",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(w.XI,{children:[(0,a.jsx)(w.A0,{children:(0,a.jsxs)(w.Hj,{children:[(0,a.jsx)(w.nd,{children:"ユーザー名"}),(0,a.jsx)(w.nd,{children:"メールアドレス"}),(0,a.jsx)(w.nd,{children:"権限"}),(0,a.jsx)(w.nd,{children:"ステータス"}),(0,a.jsx)(w.nd,{children:"最終ログイン"}),(0,a.jsx)(w.nd,{children:"作成日"}),(0,a.jsx)(w.nd,{className:"w-[70px]",children:"操作"})]})}),(0,a.jsx)(w.BF,{children:e.map(e=>(0,a.jsxs)(w.Hj,{children:[(0,a.jsx)(w.nA,{className:"font-medium",children:e.name}),(0,a.jsx)(w.nA,{children:e.email}),(0,a.jsx)(w.nA,{children:(0,a.jsxs)(m.l6,{value:e.role,onValueChange:s=>x(e.id,s),disabled:n,children:[(0,a.jsx)(m.bq,{className:"w-[140px]",children:(0,a.jsx)(m.yv,{})}),(0,a.jsxs)(m.gC,{children:[(0,a.jsx)(m.eb,{value:"viewer",children:"閲覧者"}),(0,a.jsx)(m.eb,{value:"user",children:"一般ユーザー"}),(0,a.jsx)(m.eb,{value:"admin",children:"管理者"})]})]})}),(0,a.jsx)(w.nA,{children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(C.d,{checked:e.is_active,onCheckedChange:()=>h(e.id,!e.is_active),disabled:n}),(0,a.jsx)("span",{className:"text-sm",children:e.is_active?"有効":"無効"})]})}),(0,a.jsx)(w.nA,{children:e.last_login?j(e.last_login):"未ログイン"}),(0,a.jsx)(w.nA,{children:j(e.created_at)}),(0,a.jsx)(w.nA,{children:(0,a.jsx)(_.E,{variant:e.is_active?"default":"outline",children:e.is_active?"アクティブ":"非アクティブ"})})]},e.id))})]}),(0,a.jsx)(ed,{open:null!==l,onOpenChange:e=>!e&&d(null),title:"activate"===c?"ユーザー有効化の確認":"ユーザー無効化の確認",description:"activate"===c?"このユーザーを有効化しますか？有効化されたユーザーはシステムにログインできるようになります。":"このユーザーを無効化しますか？無効化されたユーザーはシステムにログインできなくなります。",onConfirm:p,confirmText:"activate"===c?"有効化":"無効化",cancelText:"キャンセル"})]})}var eu=t(7313),em=t(8819),ex=t(1860),eh=t(9266);let ep={company_name:"",phone:"",email:"",website:"",address:"",postal_code:"",description:"",ceo_name:"",established_year:new Date().getFullYear(),employee_count:0};function ej({onSave:e}){let[s,t]=(0,i.useState)(ep),[r,l]=(0,i.useState)(!1),[c,m]=(0,i.useState)(!1),[h,p]=(0,i.useState)({}),j=()=>{let e={};return s.company_name.trim()||(e.company_name="会社名は必須です"),s.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.email)&&(e.email="無効なメール形式です"),s.website&&!/^https?:\/\/.+/.test(s.website)&&(e.website="ウェブサイトはhttp://またはhttps://で始まる必要があります"),s.phone&&!/^[\d\-\+\(\)\s]+$/.test(s.phone)&&(e.phone="無効な電話番号形式です"),s.postal_code&&!/^\d{3}-\d{4}$/.test(s.postal_code)&&(e.postal_code="郵便番号は000-0000の形式で入力してください"),(s.established_year<1800||s.established_year>new Date().getFullYear())&&(e.established_year="設立年は1800年から現在年までの範囲で入力してください"),s.employee_count<0&&(e.employee_count="従業員数は正の数である必要があります"),p(e),0===Object.keys(e).length},v=async t=>{if(t.preventDefault(),j()){m(!0);try{localStorage.setItem("company_settings",JSON.stringify(s));try{await eh.uE.post("/settings/company",s)}catch(e){}e&&e(s),(0,ec.oR)({title:"設定を保存しました",description:"会社情報が正常に保存されました"})}catch(e){(0,ec.oR)({title:"保存に失敗しました",description:"設定の保存中にエラーが発生しました",variant:"destructive"})}finally{m(!1)}}},g=(e,s)=>{t(t=>({...t,[e]:s})),h[e]&&p(s=>({...s,[e]:""}))};return r?(0,a.jsxs)(n.Zp,{children:[(0,a.jsxs)(n.aR,{children:[(0,a.jsxs)(n.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(eu.A,{className:"h-5 w-5"}),"会社情報設定"]}),(0,a.jsx)(n.BT,{children:"システムで使用する会社情報を設定します"})]}),(0,a.jsx)(n.Wu,{children:(0,a.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"}),(0,a.jsx)("span",{className:"ml-2",children:"設定を読み込み中..."})]})})]}):(0,a.jsxs)(n.Zp,{children:[(0,a.jsxs)(n.aR,{children:[(0,a.jsxs)(n.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(eu.A,{className:"h-5 w-5"}),"会社情報設定"]}),(0,a.jsx)(n.BT,{children:"システムで使用する会社情報を設定します"})]}),(0,a.jsx)(n.Wu,{children:(0,a.jsxs)("form",{onSubmit:v,noValidate:!0,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)(u.J,{htmlFor:"company_name",children:"会社名 *"}),(0,a.jsx)(o.p,{id:"company_name",value:s.company_name,onChange:e=>g("company_name",e.target.value),disabled:c,className:h.company_name?"border-destructive":"",placeholder:"株式会社サンプル"}),h.company_name&&(0,a.jsx)("p",{className:"text-sm text-destructive mt-1",children:h.company_name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(u.J,{htmlFor:"ceo_name",children:"代表者名"}),(0,a.jsx)(o.p,{id:"ceo_name",value:s.ceo_name,onChange:e=>g("ceo_name",e.target.value),disabled:c,placeholder:"田中太郎"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(u.J,{htmlFor:"established_year",children:"設立年"}),(0,a.jsx)(o.p,{id:"established_year",type:"number",min:"1800",max:new Date().getFullYear(),value:s.established_year,onChange:e=>g("established_year",Number.parseInt(e.target.value)||0),disabled:c,className:h.established_year?"border-destructive":""}),h.established_year&&(0,a.jsx)("p",{className:"text-sm text-destructive mt-1",children:h.established_year})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(u.J,{htmlFor:"employee_count",children:"従業員数"}),(0,a.jsx)(o.p,{id:"employee_count",type:"number",min:"0",value:s.employee_count,onChange:e=>g("employee_count",Number.parseInt(e.target.value)||0),disabled:c,className:h.employee_count?"border-destructive":""}),h.employee_count&&(0,a.jsx)("p",{className:"text-sm text-destructive mt-1",children:h.employee_count})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(u.J,{htmlFor:"phone",children:"電話番号"}),(0,a.jsx)(o.p,{id:"phone",value:s.phone,onChange:e=>g("phone",e.target.value),disabled:c,className:h.phone?"border-destructive":"",placeholder:"03-1234-5678"}),h.phone&&(0,a.jsx)("p",{className:"text-sm text-destructive mt-1",children:h.phone})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(u.J,{htmlFor:"email",children:"メールアドレス"}),(0,a.jsx)(o.p,{id:"email",type:"email",value:s.email,onChange:e=>g("email",e.target.value),disabled:c,className:h.email?"border-destructive":"",placeholder:"info@example.com"}),h.email&&(0,a.jsx)("p",{className:"text-sm text-destructive mt-1",children:h.email})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(u.J,{htmlFor:"website",children:"ウェブサイト"}),(0,a.jsx)(o.p,{id:"website",type:"url",value:s.website,onChange:e=>g("website",e.target.value),disabled:c,className:h.website?"border-destructive":"",placeholder:"https://example.com"}),h.website&&(0,a.jsx)("p",{className:"text-sm text-destructive mt-1",children:h.website})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(u.J,{htmlFor:"postal_code",children:"郵便番号"}),(0,a.jsx)(o.p,{id:"postal_code",value:s.postal_code,onChange:e=>g("postal_code",e.target.value),disabled:c,className:h.postal_code?"border-destructive":"",placeholder:"123-4567"}),h.postal_code&&(0,a.jsx)("p",{className:"text-sm text-destructive mt-1",children:h.postal_code})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)(u.J,{htmlFor:"address",children:"住所"}),(0,a.jsx)(o.p,{id:"address",value:s.address,onChange:e=>g("address",e.target.value),disabled:c,placeholder:"東京都渋谷区渋谷1-1-1 サンプルビル10F"})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)(u.J,{htmlFor:"description",children:"会社概要"}),(0,a.jsx)(x.T,{id:"description",rows:4,value:s.description,onChange:e=>g("description",e.target.value),disabled:c,placeholder:"会社の事業内容や概要を記載してください"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 pt-4 border-t",children:[(0,a.jsxs)(d.$,{type:"submit",disabled:c,children:[(0,a.jsx)(em.A,{className:"h-4 w-4 mr-2"}),c?"保存中...":"設定を保存"]}),(0,a.jsxs)(d.$,{type:"button",variant:"outline",onClick:()=>{t(ep),p({}),(0,ec.oR)({title:"設定をリセットしました",description:"フォームが初期状態に戻りました"})},disabled:c,children:[(0,a.jsx)(ex.A,{className:"h-4 w-4 mr-2"}),"リセット"]})]})]})})]})}var ev=t(1312),eg=t(9891),ef=t(4027);function ey(){let{users:e,loading:s,error:t,refetch:i}=f();return(0,a.jsx)(r.MainLayout,{children:(0,a.jsxs)("div",{className:"container mx-auto py-6 space-y-6",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"設定"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"システムの設定とユーザー管理を行います"})]})}),(0,a.jsxs)(l.tU,{defaultValue:"users",className:"space-y-4",children:[(0,a.jsxs)(l.j7,{children:[(0,a.jsxs)(l.Xi,{value:"users",children:[(0,a.jsx)(ev.A,{className:"mr-2 h-4 w-4"}),"ユーザー管理"]}),(0,a.jsxs)(l.Xi,{value:"permissions",children:[(0,a.jsx)(eg.A,{className:"mr-2 h-4 w-4"}),"権限設定"]}),(0,a.jsxs)(l.Xi,{value:"system",children:[(0,a.jsx)(ef.A,{className:"mr-2 h-4 w-4"}),"システム設定"]})]}),(0,a.jsx)(l.av,{value:"users",className:"space-y-4",children:(0,a.jsxs)(n.Zp,{children:[(0,a.jsx)(n.aR,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(n.ZB,{children:"ユーザー管理"}),(0,a.jsx)(n.BT,{children:"システムユーザーの招待、権限変更、無効化を行います"})]}),(0,a.jsx)(N,{onUserCreated:i})]})}),(0,a.jsxs)(n.Wu,{children:[s&&(0,a.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,a.jsx)(y.k,{className:"mr-2"}),"ユーザー一覧を読み込み中..."]}),t&&(0,a.jsx)(b.$,{message:t}),!s&&!t&&(0,a.jsx)(eo,{users:e,onUserUpdated:i})]})]})}),(0,a.jsx)(l.av,{value:"permissions",className:"space-y-4",children:(0,a.jsxs)(n.Zp,{children:[(0,a.jsxs)(n.aR,{children:[(0,a.jsx)(n.ZB,{children:"権限設定"}),(0,a.jsx)(n.BT,{children:"各権限レベルの詳細設定を行います"})]}),(0,a.jsx)(n.Wu,{children:(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)("div",{className:"grid gap-4",children:[(0,a.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,a.jsx)("h3",{className:"font-semibold text-destructive",children:"管理者"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"全ての機能にアクセス可能。ユーザー管理、システム設定の変更が可能。"})]}),(0,a.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,a.jsx)("h3",{className:"font-semibold",children:"一般ユーザー"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"企業データの閲覧・編集、案件管理が可能。ユーザー管理は不可。"})]}),(0,a.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,a.jsx)("h3",{className:"font-semibold text-muted-foreground",children:"閲覧者"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"データの閲覧のみ可能。編集・削除・作成は不可。"})]})]})})})]})}),(0,a.jsx)(l.av,{value:"system",className:"space-y-4",children:(0,a.jsx)(ej,{})})]})]})})}},8245:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/app/app/settings/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/app/app/settings/page.tsx","default")},8819:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(2688).A)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9891:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(2688).A)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[188,525,133,208,146,759,628,385,976,312],()=>t(5544));module.exports=a})();