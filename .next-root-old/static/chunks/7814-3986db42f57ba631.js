"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7814],{2714:(e,t,a)=>{a.d(t,{J:()=>l});var s=a(5155);a(2115);var r=a(2797),n=a(3999);function l(e){let{className:t,...a}=e;return(0,s.jsx)(r.b,{"data-slot":"label",className:(0,n.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...a})}},3983:(e,t,a)=>{a.d(t,{B:()=>o,Kz:()=>c,aq:()=>i,tH:()=>d});var s=a(2115),r=a(7259);let n=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a]},l=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a]};function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{page:t=1,limit:a=50,filters:i={}}=e,[d,c]=(0,s.useState)([]),[o,u]=(0,s.useState)(!0),[h,m]=(0,s.useState)(null),[g,p]=(0,s.useState)({page:1,limit:50,total:0,total_pages:1}),v=async()=>{try{u(!0),m(null);let e=new URLSearchParams({page:t.toString(),page_size:a.toString(),...Object.fromEntries(Object.entries(i).filter(e=>{let[t,a]=e;return void 0!==a&&""!==a&&("industry"!==t||"all"!==a)}))}),s=await r.uE.get("/clients?".concat(e));n("一覧レスポンス",s);let d=await s.json();n("APIレスポンス構造",d),d&&"object"==typeof d?Array.isArray(d.results)?(c(d.results),p({page:t,limit:a,total:d.count||0,total_pages:Math.ceil((d.count||0)/a)})):Array.isArray(d)?(c(d),p({page:t,limit:a,total:d.length,total_pages:Math.ceil(d.length/a)})):(l("Unexpected response format",d),m("予期しないAPIレスポンス形式")):m("APIからデータを取得できませんでした")}catch(e){m(e instanceof Error?e.message:"クライアント一覧の取得に失敗しました")}finally{u(!1)}};(0,s.useEffect)(()=>{v()},[t,a,JSON.stringify(i)]);let x=async e=>{try{n("クライアント作成",e);let t=await r.uE.post("/clients/",e);if(t.ok){let e=await t.json();return n("クライアント作成成功",e),await v(),e}throw Error("クライアントの作成に失敗しました")}catch(e){throw e}},j=async(e,t)=>{try{n("クライアント更新",{id:e,clientData:t});let a=await r.uE.put("/clients/".concat(e,"/"),t);if(a.ok){let e=await a.json();return n("クライアント更新成功",e),await v(),e}throw Error("クライアントの更新に失敗しました")}catch(e){throw e}};return{clients:d,loading:o,error:h,pagination:g,refetch:v,createClient:x,updateClient:j}}function d(e){let[t,a]=(0,s.useState)(null),[l,i]=(0,s.useState)(!0),[d,c]=(0,s.useState)(null),o=async()=>{try{i(!0),c(null),n("クライアント詳細を取得",{id:e});let t=await r.uE.get("/clients/".concat(e));if(t.ok){let e=await t.json();n("クライアント詳細取得成功",e),e&&e.id?a(e):c("クライアント詳細データが見つかりません")}else throw Error("クライアント詳細の取得に失敗しました")}catch(e){c(e instanceof Error?e.message:"クライアント詳細の取得に失敗しました")}finally{i(!1)}};return(0,s.useEffect)(()=>{e&&o()},[e]),{client:t,loading:l,error:d,refetch:o}}function c(e){let[t,a]=(0,s.useState)(null),[l,i]=(0,s.useState)(!0),[d,c]=(0,s.useState)(null),o=async()=>{try{i(!0),c(null),n("クライアント統計情報を取得",{id:e});let t=await r.uE.get("/clients/".concat(e,"/stats"));if(t.ok){let e=await t.json();n("クライアント統計情報取得成功",e),e?a(e):c("統計情報が見つかりません")}else throw Error("統計情報の取得に失敗しました")}catch(e){c(e instanceof Error?e.message:"統計情報の取得に失敗しました")}finally{i(!1)}};return(0,s.useEffect)(()=>{e&&o()},[e]),{stats:t,loading:l,error:d,refetch:o}}function o(e){let[t,a]=(0,s.useState)([]),[l,i]=(0,s.useState)(!0),[d,c]=(0,s.useState)(null),o=async()=>{try{i(!0),c(null),n("クライアント関連案件を取得",{id:e});let t=await r.uE.get("/clients/".concat(e,"/projects"));if(t.ok){let e=await t.json();n("クライアント関連案件取得成功",e),e&&Array.isArray(e.results)?a(e.results):e&&Array.isArray(e)?a(e):c("関連案件データが見つかりません")}else throw Error("関連案件の取得に失敗しました")}catch(e){c(e instanceof Error?e.message:"関連案件の取得に失敗しました")}finally{i(!1)}};return(0,s.useEffect)(()=>{e&&o()},[e]),{projects:t,loading:l,error:d,refetch:o}}},4748:(e,t,a)=>{a.d(t,{o:()=>l});var s=a(2115),r=a(98),n=a(7259);function l(){let[e,t]=(0,s.useState)([]),[a,l]=(0,s.useState)([]),[i,d]=(0,s.useState)([]),[c,o]=(0,s.useState)(!0),[u,h]=(0,s.useState)(null);return(0,s.useEffect)(()=>{(async()=>{try{o(!0),h(null);let e=await r.uE.get(n.i3.ENDPOINTS.MASTER_INDUSTRIES);t(e.results||[]);let a=await r.uE.get(n.i3.ENDPOINTS.MASTER_STATUSES);l(a.results||[]);let s=await r.uE.get(n.i3.ENDPOINTS.MASTER_PREFECTURES);d(s.results||[])}catch(e){h(e instanceof Error?e.message:"マスターデータの取得に失敗しました")}finally{o(!1)}})()},[]),{industries:e,statuses:a,prefectures:i,loading:c,error:u}}},7814:(e,t,a)=>{a.d(t,{o:()=>p});var s=a(5155),r=a(2115),n=a(7168),l=a(9852),i=a(2714),d=a(9474),c=a(5784),o=a(8482),u=a(3983),h=a(4229),m=a(4416),g=a(4748);function p(e){var t;let{project:a,onSave:p,onCancel:v,isLoading:x=!1}=e,{statuses:j}=(0,g.o)(),[_,f]=(0,r.useState)({name:(null==a?void 0:a.name)||"",client_id:(null==a?void 0:a.client_id)||"",description:(null==a?void 0:a.description)||"",manager:(null==a?void 0:a.manager)||"",target_industry:(null==a?void 0:a.target_industry)||"",target_company_size:(null==a?void 0:a.target_company_size)||"",status:(null==a?void 0:a.status)||"active",start_date:(null==a?void 0:a.start_date)||"",end_date:(null==a?void 0:a.end_date)||""}),[y,b]=(0,r.useState)({}),{clients:S,loading:w}=(0,u.aq)({limit:100}),E=()=>{let e={};return _.name.trim()||(e.name="案件名は必須です"),_.client_id||(e.client_id="クライアントは必須です"),_.start_date||(e.start_date="契約開始日は必須です"),_.end_date&&_.start_date&&new Date(_.end_date)<new Date(_.start_date)&&(e.end_date="契約終了日は契約開始日より後である必要があります"),b(e),0===Object.keys(e).length},N=async e=>{if(e.preventDefault(),E())try{await p(_)}catch(e){}},A=(e,t)=>{f(a=>({...a,[e]:t})),y[e]&&b(t=>({...t,[e]:""}))};return(0,s.jsxs)(o.Zp,{children:[(0,s.jsx)(o.aR,{children:(0,s.jsx)(o.ZB,{children:a?"案件を編集":"新しい案件を作成"})}),(0,s.jsx)(o.Wu,{children:(0,s.jsxs)("form",{onSubmit:N,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)(i.J,{htmlFor:"name",children:"案件名 *"}),(0,s.jsx)(l.p,{id:"name",value:_.name,onChange:e=>A("name",e.target.value),disabled:x,className:y.name?"border-destructive":""}),y.name&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:y.name})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)(i.J,{htmlFor:"client_id",children:"クライアント *"}),(0,s.jsxs)(c.l6,{value:null===(t=_.client_id)||void 0===t?void 0:t.toString(),onValueChange:e=>A("client_id",e),children:[(0,s.jsx)(c.bq,{className:y.client_id?"border-destructive":"",children:(0,s.jsx)(c.yv,{placeholder:w?"読み込み中...":"クライアントを選択"})}),(0,s.jsx)(c.gC,{children:!w&&S.map(e=>(0,s.jsx)(c.eb,{value:e.id.toString(),children:e.name},e.id))})]}),y.client_id&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:y.client_id})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(i.J,{htmlFor:"manager",children:"担当者"}),(0,s.jsx)(l.p,{id:"manager",value:_.manager,onChange:e=>A("manager",e.target.value),disabled:x,placeholder:"バジェット側担当者名"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(i.J,{htmlFor:"status",children:"ステータス"}),(0,s.jsxs)(c.l6,{value:_.status,onValueChange:e=>A("status",e),children:[(0,s.jsx)(c.bq,{children:(0,s.jsx)(c.yv,{placeholder:"ステータスを選択"})}),(0,s.jsx)(c.gC,{children:j.filter(e=>"project"===e.category).map(e=>(0,s.jsx)(c.eb,{value:e.name,children:e.name},e.name))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(i.J,{htmlFor:"target_industry",children:"ターゲット業界"}),(0,s.jsx)(l.p,{id:"target_industry",value:_.target_industry,onChange:e=>A("target_industry",e.target.value),disabled:x,placeholder:"IT・ソフトウェア"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(i.J,{htmlFor:"target_company_size",children:"ターゲット企業規模"}),(0,s.jsx)(l.p,{id:"target_company_size",value:_.target_company_size,onChange:e=>A("target_company_size",e.target.value),disabled:x,placeholder:"50-500名"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(i.J,{htmlFor:"start_date",children:"契約開始日 *"}),(0,s.jsx)(l.p,{id:"start_date",type:"date",value:_.start_date,onChange:e=>A("start_date",e.target.value),disabled:x,className:y.start_date?"border-destructive":""}),y.start_date&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:y.start_date})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(i.J,{htmlFor:"end_date",children:"契約終了日"}),(0,s.jsx)(l.p,{id:"end_date",type:"date",value:_.end_date,onChange:e=>A("end_date",e.target.value),disabled:x,className:y.end_date?"border-destructive":""}),y.end_date&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:y.end_date})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)(i.J,{htmlFor:"description",children:"説明"}),(0,s.jsx)(d.T,{id:"description",rows:4,value:_.description,onChange:e=>A("description",e.target.value),disabled:x})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 pt-4 border-t",children:[(0,s.jsxs)(n.$,{type:"submit",disabled:x,children:[(0,s.jsx)(h.A,{className:"h-4 w-4 mr-2"}),x?"保存中...":a?"変更を保存":"案件を作成"]}),(0,s.jsxs)(n.$,{type:"button",variant:"outline",onClick:v,disabled:x,children:[(0,s.jsx)(m.A,{className:"h-4 w-4 mr-2"}),"キャンセル"]})]})]})})]})}},9474:(e,t,a)=>{a.d(t,{T:()=>n});var s=a(5155);a(2115);var r=a(3999);function n(e){let{className:t,...a}=e;return(0,s.jsx)("textarea",{"data-slot":"textarea",className:(0,r.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...a})}}}]);