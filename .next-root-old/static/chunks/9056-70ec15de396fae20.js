"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9056],{88:(e,t,a)=>{a.d(t,{d:()=>l});var s=a(5155);a(2115);var r=a(7161),n=a(3999);function l(e){let{className:t,...a}=e;return(0,s.jsx)(r.bL,{"data-slot":"switch",className:(0,n.cn)("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...a,children:(0,s.jsx)(r.zi,{"data-slot":"switch-thumb",className:(0,n.cn)("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}},3983:(e,t,a)=>{a.d(t,{B:()=>d,Kz:()=>o,aq:()=>i,tH:()=>c});var s=a(2115),r=a(7259);let n=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a]},l=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a]};function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{page:t=1,limit:a=50,filters:i={}}=e,[c,o]=(0,s.useState)([]),[d,u]=(0,s.useState)(!0),[h,p]=(0,s.useState)(null),[g,f]=(0,s.useState)({page:1,limit:50,total:0,total_pages:1}),m=async()=>{try{u(!0),p(null);let e=new URLSearchParams({page:t.toString(),page_size:a.toString(),...Object.fromEntries(Object.entries(i).filter(e=>{let[t,a]=e;return void 0!==a&&""!==a&&("industry"!==t||"all"!==a)}))}),s=await r.uE.get("/clients?".concat(e));n("一覧レスポンス",s);let c=await s.json();n("APIレスポンス構造",c),c&&"object"==typeof c?Array.isArray(c.results)?(o(c.results),f({page:t,limit:a,total:c.count||0,total_pages:Math.ceil((c.count||0)/a)})):Array.isArray(c)?(o(c),f({page:t,limit:a,total:c.length,total_pages:Math.ceil(c.length/a)})):(l("Unexpected response format",c),p("予期しないAPIレスポンス形式")):p("APIからデータを取得できませんでした")}catch(e){p(e instanceof Error?e.message:"クライアント一覧の取得に失敗しました")}finally{u(!1)}};(0,s.useEffect)(()=>{m()},[t,a,JSON.stringify(i)]);let v=async e=>{try{n("クライアント作成",e);let t=await r.uE.post("/clients/",e);if(t.ok){let e=await t.json();return n("クライアント作成成功",e),await m(),e}throw Error("クライアントの作成に失敗しました")}catch(e){throw e}},x=async(e,t)=>{try{n("クライアント更新",{id:e,clientData:t});let a=await r.uE.put("/clients/".concat(e,"/"),t);if(a.ok){let e=await a.json();return n("クライアント更新成功",e),await m(),e}throw Error("クライアントの更新に失敗しました")}catch(e){throw e}};return{clients:c,loading:d,error:h,pagination:g,refetch:m,createClient:v,updateClient:x}}function c(e){let[t,a]=(0,s.useState)(null),[l,i]=(0,s.useState)(!0),[c,o]=(0,s.useState)(null),d=async()=>{try{i(!0),o(null),n("クライアント詳細を取得",{id:e});let t=await r.uE.get("/clients/".concat(e));if(t.ok){let e=await t.json();n("クライアント詳細取得成功",e),e&&e.id?a(e):o("クライアント詳細データが見つかりません")}else throw Error("クライアント詳細の取得に失敗しました")}catch(e){o(e instanceof Error?e.message:"クライアント詳細の取得に失敗しました")}finally{i(!1)}};return(0,s.useEffect)(()=>{e&&d()},[e]),{client:t,loading:l,error:c,refetch:d}}function o(e){let[t,a]=(0,s.useState)(null),[l,i]=(0,s.useState)(!0),[c,o]=(0,s.useState)(null),d=async()=>{try{i(!0),o(null),n("クライアント統計情報を取得",{id:e});let t=await r.uE.get("/clients/".concat(e,"/stats"));if(t.ok){let e=await t.json();n("クライアント統計情報取得成功",e),e?a(e):o("統計情報が見つかりません")}else throw Error("統計情報の取得に失敗しました")}catch(e){o(e instanceof Error?e.message:"統計情報の取得に失敗しました")}finally{i(!1)}};return(0,s.useEffect)(()=>{e&&d()},[e]),{stats:t,loading:l,error:c,refetch:d}}function d(e){let[t,a]=(0,s.useState)([]),[l,i]=(0,s.useState)(!0),[c,o]=(0,s.useState)(null),d=async()=>{try{i(!0),o(null),n("クライアント関連案件を取得",{id:e});let t=await r.uE.get("/clients/".concat(e,"/projects"));if(t.ok){let e=await t.json();n("クライアント関連案件取得成功",e),e&&Array.isArray(e.results)?a(e.results):e&&Array.isArray(e)?a(e):o("関連案件データが見つかりません")}else throw Error("関連案件の取得に失敗しました")}catch(e){o(e instanceof Error?e.message:"関連案件の取得に失敗しました")}finally{i(!1)}};return(0,s.useEffect)(()=>{e&&d()},[e]),{projects:t,loading:l,error:c,refetch:d}}},6108:(e,t,a)=>{a.d(t,{M:()=>m});var s=a(5155),r=a(2115),n=a(5695),l=a(7168),i=a(9852),c=a(2714),o=a(9474),d=a(88),u=a(5784),h=a(8482),p=a(2193),g=a(3014);let f=["IT・ソフトウェア","マーケティング・広告","製造業","金融・保険","不動産","小売・EC","医療・ヘルスケア","教育","その他"];function m(e){var t;let{client:a,onSubmit:m}=e,v=(0,n.useRouter)(),[x,y]=(0,r.useState)(!1),[j,b]=(0,r.useState)(null),[w,k]=(0,r.useState)({name:(null==a?void 0:a.name)||"",contact_person:(null==a?void 0:a.contact_person)||"",email:(null==a?void 0:a.email)||"",phone:(null==a?void 0:a.phone)||"",industry:(null==a?void 0:a.industry)||"",notes:(null==a?void 0:a.notes)||"",is_active:null===(t=null==a?void 0:a.is_active)||void 0===t||t}),E=async e=>{if(e.preventDefault(),!w.name.trim()){b("クライアント名は必須です");return}try{y(!0),b(null),await m({...w,projects:[],project_count:0,active_project_count:0}),v.push("/clients")}catch(e){b(e instanceof Error?e.message:"クライアントの保存に失敗しました")}finally{y(!1)}},_=(e,t)=>{k(a=>({...a,[e]:t}))};return(0,s.jsxs)(h.Zp,{children:[(0,s.jsx)(h.aR,{children:(0,s.jsx)(h.ZB,{children:a?"クライアント編集":"新規クライアント作成"})}),(0,s.jsx)(h.Wu,{children:(0,s.jsxs)("form",{onSubmit:E,className:"space-y-6",children:[j&&(0,s.jsx)(g.$,{message:j}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.J,{htmlFor:"name",children:"クライアント名 *"}),(0,s.jsx)(i.p,{id:"name",value:w.name,onChange:e=>_("name",e.target.value),placeholder:"株式会社〇〇",required:!0})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.J,{htmlFor:"contact_person",children:"担当者名"}),(0,s.jsx)(i.p,{id:"contact_person",value:w.contact_person,onChange:e=>_("contact_person",e.target.value),placeholder:"山田 太郎"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.J,{htmlFor:"email",children:"メールアドレス"}),(0,s.jsx)(i.p,{id:"email",type:"email",value:w.email,onChange:e=>_("email",e.target.value),placeholder:"contact@example.com"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.J,{htmlFor:"phone",children:"電話番号"}),(0,s.jsx)(i.p,{id:"phone",type:"tel",value:w.phone,onChange:e=>_("phone",e.target.value),placeholder:"03-1234-5678"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.J,{htmlFor:"industry",children:"業界"}),(0,s.jsxs)(u.l6,{value:w.industry,onValueChange:e=>_("industry",e),children:[(0,s.jsx)(u.bq,{children:(0,s.jsx)(u.yv,{placeholder:"業界を選択"})}),(0,s.jsx)(u.gC,{children:f.map(e=>(0,s.jsx)(u.eb,{value:e,children:e},e))})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.J,{htmlFor:"notes",children:"備考"}),(0,s.jsx)(o.T,{id:"notes",value:w.notes,onChange:e=>_("notes",e.target.value),placeholder:"クライアントに関する特記事項",rows:4})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(d.d,{id:"is_active",checked:w.is_active,onCheckedChange:e=>_("is_active",e)}),(0,s.jsx)(c.J,{htmlFor:"is_active",children:"アクティブ状態"})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,s.jsx)(l.$,{type:"button",variant:"outline",onClick:()=>v.back(),disabled:x,children:"キャンセル"}),(0,s.jsxs)(l.$,{type:"submit",disabled:x,children:[x&&(0,s.jsx)(p.k,{}),a?"更新":"作成"]})]})]})})]})}},9474:(e,t,a)=>{a.d(t,{T:()=>n});var s=a(5155);a(2115);var r=a(3999);function n(e){let{className:t,...a}=e;return(0,s.jsx)("textarea",{"data-slot":"textarea",className:(0,r.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...a})}}}]);