(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2758],{646:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},1284:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},1482:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]])},1788:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},1790:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>ea});var a=s(5155),n=s(2115),l=s(5695),r=s(5646),i=s(7168),c=s(9852),d=s(2714),o=s(5784),u=s(8482),m=s(8145),h=s(7924),x=s(4416),p=s(1482),v=s(98);let j=[{value:"active",label:"アクティブ"},{value:"prospect",label:"見込み客"},{value:"inactive",label:"非アクティブ"}];function g(e){var t,s;let{filters:l,onFiltersChange:r,onClearFilters:g,onApplyFilters:f,filtersChanged:y,hasAppliedFilters:b}=e,[N,w]=(0,n.useState)(!1),[_,C]=(0,n.useState)([]);(0,n.useEffect)(()=>{(async()=>{try{let e=await v.uE.get("/companies/"),t=[...new Set(e.results.map(e=>e.industry).filter(Boolean))];C(t.sort())}catch(e){}})()},[]);let S=(e,t)=>{r({...l,[e]:t})},k=(e,t)=>{let s=l[e]||[];s.includes(t)||S(e,[...s,t])},A=(e,t)=>{let s=l[e]||[];S(e,s.filter(e=>e!==t))};return Object.values(l).some(e=>Array.isArray(e)?e.length>0:void 0!==e&&""!==e),(0,a.jsxs)(u.Zp,{className:"mb-6",children:[(0,a.jsx)(u.aR,{className:"pb-3",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(u.ZB,{className:"text-lg flex items-center gap-2",children:[(0,a.jsx)(h.A,{className:"h-5 w-5"}),"検索・フィルター"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(i.$,{variant:"outline",size:"sm",onClick:g,className:"text-xs bg-transparent",disabled:!b&&!y,children:[(0,a.jsx)(x.A,{className:"h-3 w-3 mr-1"}),"すべてクリア"]}),(0,a.jsxs)(i.$,{size:"sm",onClick:f,disabled:!y,className:"text-xs",children:[(0,a.jsx)(h.A,{className:"h-3 w-3 mr-1"}),"検索"]}),(0,a.jsxs)(i.$,{variant:"outline",size:"sm",onClick:()=>w(!N),children:[(0,a.jsx)(p.A,{className:"h-4 w-4 mr-1"}),N?"フィルターを隠す":"フィルターを表示"]})]})]})}),(0,a.jsxs)(u.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(d.J,{htmlFor:"search",children:"企業検索"}),(0,a.jsx)(c.p,{id:"search",placeholder:"企業名、業界、所在地で検索...",value:l.search||"",onChange:e=>S("search",e.target.value)})]}),N&&(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 pt-4 border-t",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(d.J,{children:"業界"}),(0,a.jsxs)(o.l6,{onValueChange:e=>k("industry",e),children:[(0,a.jsx)(o.bq,{children:(0,a.jsx)(o.yv,{placeholder:"業界を選択"})}),(0,a.jsx)(o.gC,{children:_.map(e=>(0,a.jsx)(o.eb,{value:e,children:e},e))})]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1 mt-2",children:null===(t=l.industry)||void 0===t?void 0:t.map(e=>(0,a.jsxs)(m.E,{variant:"secondary",className:"text-xs",children:[e,(0,a.jsx)("button",{onClick:()=>A("industry",e),className:"ml-1 hover:text-destructive",children:(0,a.jsx)(x.A,{className:"h-3 w-3"})})]},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(d.J,{children:"従業員数"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(c.p,{placeholder:"最小",type:"number",value:l.employee_count_min||"",onChange:e=>S("employee_count_min",e.target.value?Number.parseInt(e.target.value):void 0)}),(0,a.jsx)(c.p,{placeholder:"最大",type:"number",value:l.employee_count_max||"",onChange:e=>S("employee_count_max",e.target.value?Number.parseInt(e.target.value):void 0)})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(d.J,{children:"売上 (\xa5)"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(c.p,{placeholder:"最小",type:"number",value:l.revenue_min||"",onChange:e=>S("revenue_min",e.target.value?Number.parseInt(e.target.value):void 0)}),(0,a.jsx)(c.p,{placeholder:"最大",type:"number",value:l.revenue_max||"",onChange:e=>S("revenue_max",e.target.value?Number.parseInt(e.target.value):void 0)})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(d.J,{children:"ステータス"}),(0,a.jsxs)(o.l6,{onValueChange:e=>k("status",e),children:[(0,a.jsx)(o.bq,{children:(0,a.jsx)(o.yv,{placeholder:"ステータスを選択"})}),(0,a.jsx)(o.gC,{children:j.map(e=>(0,a.jsx)(o.eb,{value:e.value,children:e.label},e.value))})]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1 mt-2",children:null===(s=l.status)||void 0===s?void 0:s.map(e=>{var t;return(0,a.jsxs)(m.E,{variant:"secondary",className:"text-xs",children:[(null===(t=j.find(t=>t.value===e))||void 0===t?void 0:t.label)||e,(0,a.jsx)("button",{onClick:()=>A("status",e),className:"ml-1 hover:text-destructive",children:(0,a.jsx)(x.A,{className:"h-3 w-3"})})]},e)})})]})]})]})]})}var f=s(6874),y=s.n(f),b=s(8524),N=s(7777),w=s(5139),_=s(3227),C=s(3786),S=s(1284),k=s(4616);let A=e=>new Intl.NumberFormat("ja-JP",{style:"currency",currency:"JPY",minimumFractionDigits:0}).format(e),E=e=>new Intl.NumberFormat("ja-JP").format(e),M=e=>(0,a.jsx)(m.E,{variant:{active:"default",prospect:"secondary",inactive:"outline"}[e]||"outline",children:{active:"アクティブ",prospect:"見込み客",inactive:"非アクティブ"}[e]||e});function $(e){let{companies:t,isLoading:s,onRefresh:n,selectable:l=!1,selectedIds:r=[],onSelectChange:c,onSelectAllChange:d,onAddToProject:o}=e;if(s)return(0,a.jsxs)(u.Zp,{children:[(0,a.jsx)(u.aR,{children:(0,a.jsxs)(u.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(_.A,{className:"h-5 w-5"}),"Companies"]})}),(0,a.jsx)(u.Wu,{children:(0,a.jsx)("div",{className:"space-y-3",children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,a.jsx)("div",{className:"h-12 bg-muted animate-pulse rounded"},t))})})]});let h=new Set(r),x=t.map(e=>e.id),p=x.length>0&&x.every(e=>h.has(e)),v=x.some(e=>h.has(e))&&!p;return(0,a.jsxs)(u.Zp,{children:[(0,a.jsx)(u.aR,{children:(0,a.jsxs)(u.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(_.A,{className:"h-5 w-5"}),"企業 (",t.length,")"]})}),(0,a.jsx)(u.Wu,{children:(0,a.jsx)("div",{className:"rounded-md border",children:(0,a.jsxs)(b.XI,{children:[(0,a.jsx)(b.A0,{children:(0,a.jsxs)(b.Hj,{children:[l&&(0,a.jsx)(b.nd,{className:"w-[48px]",children:(0,a.jsx)(w.S,{"aria-label":"すべての企業を選択",checked:!!p||!!v&&"indeterminate",onCheckedChange:e=>null==d?void 0:d(!0===e)})}),(0,a.jsx)(b.nd,{children:"企業名"}),(0,a.jsx)(b.nd,{children:"業界"}),(0,a.jsx)(b.nd,{children:"従業員数"}),(0,a.jsx)(b.nd,{children:"売上"}),(0,a.jsx)(b.nd,{children:"所在地"}),(0,a.jsx)(b.nd,{children:"ステータス"}),(0,a.jsx)(b.nd,{className:"w-[160px]",children:"操作"})]})}),(0,a.jsx)(b.BF,{children:0===t.length?(0,a.jsx)(b.Hj,{children:(0,a.jsx)(b.nA,{colSpan:l?8:7,className:"text-center py-8 text-muted-foreground",children:"企業が見つかりません。検索条件を調整してください。"})}):t.map(e=>{var t,s,n,r;let d=e.ng_status,u=null==d?void 0:null===(t=d.types)||void 0===t?void 0:t.includes("client"),x=null==d?void 0:null===(s=d.types)||void 0===s?void 0:s.includes("project"),p=e.is_global_ng,v=u||x||p;return(0,a.jsxs)(b.Hj,{className:h.has(e.id)?"bg-muted/30":void 0,children:[l&&(0,a.jsx)(b.nA,{className:"w-[48px]",children:(0,a.jsx)(w.S,{"aria-label":"企業を選択: ".concat(e.name),checked:h.has(e.id),onCheckedChange:t=>null==c?void 0:c(e.id,!0===t)})}),(0,a.jsx)(b.nA,{children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e.name}),e.website_url&&(0,a.jsxs)("a",{href:e.website_url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-muted-foreground hover:text-primary flex items-center gap-1 mt-1",children:[e.website_url.replace(/^https?:\/\//,""),(0,a.jsx)(C.A,{className:"h-3 w-3"})]})]}),v&&(0,a.jsx)(N.Bc,{children:(0,a.jsxs)(N.m_,{children:[(0,a.jsx)(N.k$,{children:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(S.A,{className:"h-4 w-4 text-amber-600"}),(0,a.jsx)(m.E,{variant:"outline",className:"text-xs border-amber-200 text-amber-700",children:p&&u?"複数NG":p?"グローバルNG":u?"クライアントNG":x?"案件NG":"NG"})]})}),(0,a.jsx)(N.ZI,{className:"max-w-sm",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"font-semibold text-sm",children:"NGリスト情報"}),p&&(0,a.jsxs)("div",{className:"p-2 bg-red-50 rounded border-l-2 border-red-200",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-red-800",children:"グローバルNG"}),(0,a.jsx)("p",{className:"text-xs text-red-600",children:"全案件で営業対象外"})]}),u&&(null==d?void 0:null===(n=d.reasons)||void 0===n?void 0:n.client)&&(0,a.jsxs)("div",{className:"p-2 bg-amber-50 rounded border-l-2 border-amber-200",children:[(0,a.jsxs)("p",{className:"text-sm font-medium text-amber-800",children:["クライアントNG: ",d.reasons.client.name]}),(0,a.jsxs)("p",{className:"text-xs text-amber-600",children:["理由: ",d.reasons.client.reason]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"※他のクライアントの案件には追加可能"})]}),x&&(null==d?void 0:null===(r=d.reasons)||void 0===r?void 0:r.project)&&(0,a.jsxs)("div",{className:"p-2 bg-blue-50 rounded border-l-2 border-blue-200",children:[(0,a.jsxs)("p",{className:"text-sm font-medium text-blue-800",children:["案件NG: ",d.reasons.project.name]}),(0,a.jsxs)("p",{className:"text-xs text-blue-600",children:["理由: ",d.reasons.project.reason]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"※他の案件には追加可能"})]})]})})]})})]})}),(0,a.jsx)(b.nA,{children:e.industry}),(0,a.jsx)(b.nA,{children:E(e.employee_count)}),(0,a.jsx)(b.nA,{children:A(e.revenue)}),(0,a.jsx)(b.nA,{children:e.prefecture}),(0,a.jsx)(b.nA,{children:M(e.status||"active")}),(0,a.jsx)(b.nA,{children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(i.$,{asChild:!0,variant:"outline",size:"sm",children:(0,a.jsx)(y(),{href:"/companies/".concat(e.id),children:"詳細"})}),o&&(0,a.jsxs)(i.$,{type:"button",variant:"secondary",size:"sm",onClick:()=>o(e),disabled:v,children:[(0,a.jsx)(k.A,{className:"h-4 w-4 mr-1"}),"案件追加"]})]})})]},e.id)})})]})})})]})}var F=s(9840),I=s(6193),L=s(9026);let O=["name","industry","employee_count","revenue","location","website","phone","email","description","status"],P={name:"Company Name",industry:"Industry",employee_count:"Employee Count",revenue:"Revenue (\xa5)",location:"Location",website:"Website",phone:"Phone",email:"Email",description:"Description",status:"Status"},R={name:"企業名",industry:"業種",employee_count:"従業員数",revenue:"売上（円）",location:"所在地",website:"WebサイトURL",phone:"電話番号",email:"メールアドレス",description:"備考",status:"ステータス"};function T(e,t){let s=new Blob([e],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a");if(void 0!==a.download){let e=URL.createObjectURL(s);a.setAttribute("href",e),a.setAttribute("download",t),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)}}var V=s(7434),G=s(1788);function J(){return(0,a.jsxs)(u.Zp,{children:[(0,a.jsx)(u.aR,{children:(0,a.jsxs)(u.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(V.A,{className:"h-5 w-5"}),"CSV Template"]})}),(0,a.jsxs)(u.Wu,{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Download a CSV template with the correct format and sample data to help you prepare your company import file."}),(0,a.jsxs)(i.$,{variant:"outline",onClick:()=>{T([O.map(e=>P[e]).join(","),"Tech Solutions Inc.,Technology,150,5000000,Tokyo Japan,https://techsolutions.com,+81-3-1234-5678,contact@techsolutions.com,Leading technology solutions provider,active","Global Manufacturing Co.,Manufacturing,500,25000000,Osaka Japan,https://globalmanufacturing.com,+81-6-9876-5432,info@globalmanufacturing.com,International manufacturing company,prospect"].join("\n"),"company-import-template.csv")},children:[(0,a.jsx)(G.A,{className:"h-4 w-4 mr-2"}),"Download Template"]})]})]})}var z=s(9869);function D(e){let{onFileSelect:t}=e,s=(0,n.useRef)(null);return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"border-2 border-dashed border-muted-foreground/25 rounded-lg p-8 text-center",children:[(0,a.jsx)(V.A,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),(0,a.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Upload CSV File"}),(0,a.jsx)("p",{className:"text-muted-foreground mb-4",children:"Select a CSV file containing company data to import"}),(0,a.jsx)("input",{ref:s,type:"file",accept:".csv",onChange:e=>{var s;let a=null===(s=e.target.files)||void 0===s?void 0:s[0];a&&t(a)},className:"hidden"}),(0,a.jsxs)(i.$,{onClick:()=>{var e;return null===(e=s.current)||void 0===e?void 0:e.click()},children:[(0,a.jsx)(z.A,{className:"h-4 w-4 mr-2"}),"Choose CSV File"]})]}),(0,a.jsx)(J,{}),(0,a.jsx)(L.Fc,{children:(0,a.jsxs)(L.TN,{children:[(0,a.jsx)("strong",{children:"CSV Format Requirements:"}),(0,a.jsxs)("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[(0,a.jsx)("li",{children:"Required columns: Company Name, Industry"}),(0,a.jsx)("li",{children:"Optional columns: Employee Count, Revenue, Location, Website, Phone, Email, Description, Status"}),(0,a.jsx)("li",{children:"First row should contain column headers"}),(0,a.jsx)("li",{children:"Use UTF-8 encoding for special characters"})]})]})})]})}var H=s(3014),B=s(2193),U=s(646);function q(e){let{file:t,csvData:s,validationErrors:n,isProcessing:l,onCancel:r,onContinue:c}=e;return l?(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsx)(B.k,{text:"CSVファイルを解析しています..."})}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(V.A,{className:"h-5 w-5"}),(0,a.jsx)("span",{className:"font-medium",children:t.name}),(0,a.jsxs)(m.E,{variant:"outline",children:[s.length,"行"]})]}),n.length>0?(0,a.jsx)(H.$,{title:"".concat(n.length,"件のエラーを検出しました"),message:"以下の内容を修正してからインポートを実行してください。",errors:n.slice(0,10).map(e=>{let t=e.row>0?"".concat(e.row,"行目"):"全体",s=e.value&&String(e.value).trim()?"（入力値: ".concat(e.value,"）"):"";return"".concat(t,": ").concat(e.message).concat(s)})}):(0,a.jsxs)(L.Fc,{children:[(0,a.jsx)(U.A,{className:"h-4 w-4"}),(0,a.jsxs)(L.TN,{children:["CSVの検証が完了しました。",s.length,"件の企業データをインポートできます。"]})]}),s.length>0&&(0,a.jsxs)("div",{className:"border rounded-lg",children:[(0,a.jsx)("div",{className:"p-4 border-b",children:(0,a.jsx)("h4",{className:"font-medium",children:"Data Preview (first 5 rows)"})}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(b.XI,{children:[(0,a.jsx)(b.A0,{children:(0,a.jsxs)(b.Hj,{children:[(0,a.jsx)(b.nd,{children:"Name"}),(0,a.jsx)(b.nd,{children:"Industry"}),(0,a.jsx)(b.nd,{children:"Employees"}),(0,a.jsx)(b.nd,{children:"Revenue"}),(0,a.jsx)(b.nd,{children:"Location"})]})}),(0,a.jsx)(b.BF,{children:s.slice(0,5).map((e,t)=>(0,a.jsxs)(b.Hj,{children:[(0,a.jsx)(b.nA,{children:e.name}),(0,a.jsx)(b.nA,{children:e.industry}),(0,a.jsx)(b.nA,{children:e.employee_count}),(0,a.jsx)(b.nA,{children:e.revenue}),(0,a.jsx)(b.nA,{children:e.location})]},t))})]})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(i.$,{variant:"outline",onClick:r,children:[(0,a.jsx)(x.A,{className:"h-4 w-4 mr-2"}),"キャンセル"]}),0===n.length&&(0,a.jsx)(i.$,{onClick:c,children:"インポートへ進む"})]})]})}function Z(e){let{open:t,onOpenChange:s,onImport:l}=e,[r,c]=(0,n.useState)(null),[d,o]=(0,n.useState)([]),[u,m]=(0,n.useState)([]),[h,x]=(0,n.useState)(!1),[p,v]=(0,n.useState)(!1),[j,g]=(0,n.useState)(0),[f,y]=(0,n.useState)("upload"),b=async e=>{x(!0);try{let t=await e.text(),s=function(e){let t=e.split("\n").filter(e=>e.trim());if(t.length<2)throw Error("CSVファイルにはヘッダー行と1件以上のデータ行が必要です。");let s=t[0].split(",").map(e=>e.trim().replace(/"/g,""));return t.slice(1).map((e,t)=>{let a=function(e){let t=[],s="",a=!1;for(let n=0;n<e.length;n++){let l=e[n],r=e[n+1];'"'===l?a&&'"'===r?(s+='"',n++):a=!a:","!==l||a?s+=l:(t.push(s),s="")}return t.push(s),t}(e);if(a.length!==s.length)throw Error("".concat(t+2,"行目: 列数が一致しません（期待: ").concat(s.length,"列 / 実際: ").concat(a.length,"列）"));let n={};return s.forEach((e,t)=>{var s;n[function(e){let t=e.toLowerCase().replace(/[^a-z0-9]/g,"_");return({company_name:"name",company:"name",employees:"employee_count",employee_count:"employee_count",staff_count:"employee_count",revenue:"revenue",revenue____:"revenue",annual_revenue:"revenue",sales:"revenue",industry:"industry",sector:"industry",location:"location",address:"location",city:"location",website:"website",url:"website",web:"website",phone:"phone",telephone:"phone",tel:"phone",email:"email",e_mail:"email",description:"description",notes:"description",status:"status",state:"status"})[t]||t}(e)]=(null===(s=a[t])||void 0===s?void 0:s.trim())||""}),n})}(t),a=function(e){let t=[],s=e=>R[e]||e;return e.forEach((e,a)=>{let n=a+2,l=(e,a,l)=>{let r=s(e);t.push({row:n,field:e,value:null==a?"":String(a),message:"「".concat(r,"」列: ").concat(l)})};e.employee_count&&isNaN(Number(e.employee_count))&&l("employee_count",e.employee_count,"数値で入力してください"),e.revenue&&isNaN(Number(e.revenue))&&l("revenue",e.revenue,"数値で入力してください"),e.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.email)&&l("email",e.email,"メールアドレスの形式が正しくありません"),e.website&&e.website.trim()&&!/^https?:\/\/.+/.test(e.website)&&l("website",e.website,"http:// または https:// から始まるURLを入力してください");let r=["active","prospect","inactive"];e.status&&!r.includes(e.status.toLowerCase())&&l("status",e.status,"次のいずれかの値を指定してください: ".concat(r.join(", ")))}),t}(s);o(s),m(a),0===a.length&&y("import")}catch(e){m([{row:0,field:"file",value:"",message:e instanceof Error?e.message:"CSVファイルの解析に失敗しました。形式を確認してください。"}])}finally{x(!1)}},N=async()=>{if(!(u.length>0)){v(!0),g(0);try{let e=d.map((e,t)=>{var s,a,n,l,r,i,c,d,o,u;let m=null===(s=e.name)||void 0===s?void 0:s.trim();return{name:m&&m.length>0?m:"インポート企業（行".concat(t+2,"）"),industry:(null===(a=e.industry)||void 0===a?void 0:a.trim())||"",employee_count:Number(e.employee_count)||0,revenue:Number(e.revenue)||0,location:(null===(n=e.location)||void 0===n?void 0:n.trim())||"",website:(null===(l=e.website)||void 0===l?void 0:l.trim())||"",phone:(null===(r=e.phone)||void 0===r?void 0:r.trim())||"",email:(null===(i=e.email)||void 0===i?void 0:i.trim())||"",description:(null===(c=e.description)||void 0===c?void 0:c.trim())||"",status:(null===(d=e.status)||void 0===d?void 0:d.toLowerCase())||"prospect",established_year:new Date().getFullYear(),prefecture:"",city:"",website_url:(null===(o=e.website)||void 0===o?void 0:o.trim())||"",contact_email:(null===(u=e.email)||void 0===u?void 0:u.trim())||"",notes:"",is_global_ng:!1,capital:0}});for(let e=0;e<=100;e+=10)g(e),await new Promise(e=>setTimeout(e,100));await l(e),y("complete")}catch(e){m([{row:0,field:"import",value:"",message:"インポート処理でエラーが発生しました。内容を確認して再度お試しください。"}])}finally{v(!1)}}},w=()=>{c(null),o([]),m([]),x(!1),v(!1),g(0),y("upload")},_=()=>{w(),s(!1)};return(0,a.jsx)(F.lG,{open:t,onOpenChange:_,children:(0,a.jsxs)(F.Cf,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[(0,a.jsx)(F.c7,{children:(0,a.jsxs)(F.L3,{className:"flex items-center gap-2",children:[(0,a.jsx)(z.A,{className:"h-5 w-5"}),"CSVから企業データをインポート"]})}),(0,a.jsxs)("div",{className:"space-y-6",children:["upload"===f&&(0,a.jsx)(D,{onFileSelect:e=>{c(e),y("validate"),b(e)}}),"validate"===f&&r&&(0,a.jsx)(q,{file:r,csvData:d,validationErrors:u,isProcessing:h,onCancel:w,onContinue:()=>y("import")}),"import"===f&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(L.Fc,{children:(0,a.jsxs)(L.TN,{children:[d.length,"件の企業データをインポートします。この操作により新しい企業が登録されます。"]})}),p&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{children:"インポート中..."}),(0,a.jsxs)("span",{children:[j,"%"]})]}),(0,a.jsx)(I.k,{value:j})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(i.$,{variant:"outline",onClick:()=>y("validate"),disabled:p,children:"戻る"}),(0,a.jsx)(i.$,{onClick:N,disabled:p,children:p?"インポート中...":"インポート開始（".concat(d.length,"件）")})]})]}),"complete"===f&&(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(U.A,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium mb-2",children:"インポートが完了しました"}),(0,a.jsxs)("p",{className:"text-muted-foreground mb-4",children:[d.length,"件の企業データを登録しました。"]}),(0,a.jsx)(i.$,{onClick:_,children:"閉じる"})]})]})]})})}var X=s(3518),W=s(7259),Y=s(1863);let K=(0,s(9946).A)("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);var Q=s(3580),ee=s(4964);function et(e){let{open:t,onOpenChange:s,companies:l,onCompleted:r}=e,[u,h]=(0,n.useState)("existing"),[x,p]=(0,n.useState)([]),[j,g]=(0,n.useState)([]),[f,y]=(0,n.useState)(""),[N,_]=(0,n.useState)([]),[C,S]=(0,n.useState)(null),[k,A]=(0,n.useState)(""),[E,M]=(0,n.useState)(!1),[$,I]=(0,n.useState)(!1),[O,P]=(0,n.useState)(!1),[R,T]=(0,n.useState)(null),V=(0,n.useMemo)(()=>l.filter(e=>{var t;return!(null===(t=e.ng_status)||void 0===t?void 0:t.is_ng)&&!e.is_global_ng}),[l]),G=(0,n.useMemo)(()=>l.filter(e=>{var t;return(null===(t=e.ng_status)||void 0===t?void 0:t.is_ng)||e.is_global_ng}),[l]),J=(0,n.useMemo)(()=>{let e=f.trim().toLowerCase();return e?x.filter(t=>"".concat(t.name," ").concat(t.client_name||"").toLowerCase().includes(e)):x},[f,x]),z=(0,n.useMemo)(()=>new Set(N.map(e=>Number(e))),[N]),D=(0,n.useMemo)(()=>J.filter(e=>z.has(Number(e.id))).length,[J,z]),H=(0,n.useMemo)(()=>0!==J.length&&0!==D&&(D===J.length||"indeterminate"),[J.length,D]),B=(0,n.useCallback)(e=>{if(0!==J.length){if(!e){let e=new Set(J.map(e=>Number(e.id)));_(t=>t.filter(t=>!e.has(Number(t))));return}_(e=>{let t=new Set(e);return J.forEach(e=>t.add(Number(e.id))),Array.from(t)})}},[J]),U=(0,n.useCallback)(()=>{h("existing"),_([]),S(null),A(""),y(""),T(null),P(!1)},[]),q=(0,n.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";M(!0);try{let t=e?"&search=".concat(encodeURIComponent(e)):"",s=await v.uE.get("/projects?management_mode=true&page=1&limit=200&ordering=-id".concat(t));p(s.results||[])}catch(e){p([])}finally{M(!1)}},[]),Z=(0,n.useCallback)(async()=>{I(!0);try{let e=await v.uE.get("/clients/?page=1&page_size=100&ordering=-created_at");g(e.results||[])}catch(e){g([])}finally{I(!1)}},[]);(0,n.useEffect)(()=>{t?Z():U()},[t,Z,U]),(0,n.useEffect)(()=>{t&&q(f.trim())},[t,f,q]);let X=(0,n.useCallback)(async()=>{if(0===N.length){T("案件を選択してください。");return}if(0===V.length){T("NG企業を除く選択可能な企業がありません。");return}P(!0),T(null);try{let n=[],l=[];for(let r of N){var e,t,s,a;let i=(null===(e=x.find(e=>e.id===r))||void 0===e?void 0:e.name)||"選択した案件";try{let e=await v.uE.post("/projects/".concat(r,"/add-companies/"),{company_ids:V.map(e=>e.id)});n.push({projectId:r,projectName:i,addedCount:null!==(s=e.added_count)&&void 0!==s?s:0,errors:null!==(a=e.errors)&&void 0!==a?a:[]}),(null===(t=e.errors)||void 0===t?void 0:t.length)&&l.push(...e.errors)}catch(t){let e=t instanceof Error?t.message:"案件への追加に失敗しました。";n.push({projectId:r,projectName:i,addedCount:0,errors:[e]}),l.push("".concat(i,": ").concat(e))}}n.length>0&&(null==r||r(n),_([])),l.length>0&&T(l.join("\n"))}catch(e){T(e instanceof Error?e.message:"案件への追加に失敗しました。")}finally{P(!1)}},[V,r,x,N]),W=(0,n.useCallback)(async()=>{if(!k.trim()){T("案件名を入力してください。");return}if(!C){T("クライアントを選択してください。");return}if(0===V.length){T("NG企業を除く選択可能な企業がありません。");return}P(!0),T(null);try{let e=await v.uE.post("/projects/",{name:k.trim(),client_id:C}),t=await v.uE.post("/projects/".concat(e.id,"/add-companies/"),{company_ids:V.map(e=>e.id)});null==r||r([{projectId:Number(e.id),projectName:e.name,addedCount:t.added_count||0,errors:t.errors||[]}])}catch(e){T(e instanceof Error?e.message:"新規案件の作成に失敗しました。")}finally{P(!1)}},[V,k,r,C]);return(0,a.jsx)(F.lG,{open:t,onOpenChange:s,children:(0,a.jsxs)(F.Cf,{className:"max-w-6xl xl:max-w-7xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)(F.c7,{children:[(0,a.jsx)(F.L3,{children:"案件に企業を追加"}),(0,a.jsx)(F.rr,{children:"選択した企業を既存の案件に追加するか、新規案件を作成して割り当てます。"})]}),0===l.length?(0,a.jsx)("div",{className:"py-8 text-center text-muted-foreground",children:"企業が選択されていません。"}):(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{className:"grid gap-6 lg:grid-cols-[minmax(0,360px)_minmax(0,1fr)] xl:grid-cols-[420px_minmax(0,1fr)]",children:[(0,a.jsxs)("section",{className:"space-y-3",children:[(0,a.jsx)(d.J,{children:"選択中の企業"}),(0,a.jsx)("div",{className:"max-h-52 overflow-y-auto rounded-md border p-3",children:(0,a.jsx)("div",{className:"space-y-2",children:l.map(e=>{let t=G.some(t=>t.id===e.id);return(0,a.jsxs)("div",{className:"flex items-center justify-between rounded border px-3 py-2 text-sm ".concat(t?"border-red-200 bg-red-50 text-red-700":"border-muted bg-background"),children:[(0,a.jsx)("span",{children:e.name}),t&&(0,a.jsx)(m.E,{variant:"destructive",children:"NG"})]},e.id)})})}),(0,a.jsxs)("div",{className:"rounded-md border bg-muted/30 px-3 py-2 text-sm leading-relaxed text-muted-foreground",children:[(0,a.jsxs)("div",{children:["利用可能: ",V.length,"社 / 選択総数: ",l.length,"社"]}),(0,a.jsx)("div",{children:"NG企業は案件追加対象から自動的に除外されます。"})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[G.length>0&&(0,a.jsxs)(L.Fc,{variant:"destructive",children:[(0,a.jsx)(L.XL,{children:"NG企業が含まれています"}),(0,a.jsx)(L.TN,{children:"グローバルNGまたはクライアントNG企業は案件に追加できません。NG企業は自動的に除外されます。"})]}),R&&(0,a.jsxs)(L.Fc,{variant:"destructive",children:[(0,a.jsx)(L.XL,{children:"エラーが発生しました"}),(0,a.jsx)(L.TN,{children:R})]}),(0,a.jsxs)(ee.tU,{value:u,onValueChange:e=>{h(e),T(null)},children:[(0,a.jsxs)(ee.j7,{children:[(0,a.jsx)(ee.Xi,{value:"existing",children:"既存の案件に追加"}),(0,a.jsx)(ee.Xi,{value:"new",children:"新規案件を作成"})]}),(0,a.jsxs)(ee.av,{value:"existing",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.J,{htmlFor:"project-search",children:"案件検索"}),(0,a.jsx)(c.p,{id:"project-search",placeholder:"案件名やクライアント名で検索",value:f,onChange:e=>y(e.target.value)})]}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3 text-sm text-muted-foreground",children:[(0,a.jsxs)("span",{children:["選択中の案件: ",N.length," / ",J.length," 件"]}),(0,a.jsx)("span",{children:"表示件数は最大100件です。"})]}),(0,a.jsx)("div",{className:"max-h-72 overflow-y-auto rounded border bg-background",children:(0,a.jsxs)(b.XI,{children:[(0,a.jsx)(b.A0,{children:(0,a.jsxs)(b.Hj,{children:[(0,a.jsx)(b.nd,{className:"w-16",children:(0,a.jsx)(w.S,{"aria-label":"表示中の案件を全選択",checked:H,disabled:O||0===J.length,onCheckedChange:e=>{B(!0===e)}})}),(0,a.jsx)(b.nd,{children:"案件名"}),(0,a.jsx)(b.nd,{children:"クライアント"})]})}),(0,a.jsx)(b.BF,{children:E?(0,a.jsx)(b.Hj,{children:(0,a.jsx)(b.nA,{colSpan:3,className:"py-6 text-center text-muted-foreground",children:"案件を読み込み中..."})}):0===J.length?(0,a.jsx)(b.Hj,{children:(0,a.jsx)(b.nA,{colSpan:3,className:"py-6 text-center text-muted-foreground",children:"該当する案件がありません。"})}):J.map(e=>(0,a.jsxs)(b.Hj,{children:[(0,a.jsx)(b.nA,{className:"w-12",children:(0,a.jsx)(w.S,{"aria-label":"案件を選択: ".concat(e.name),checked:z.has(Number(e.id)),disabled:O,onCheckedChange:t=>{_(s=>{let a=new Set(s);return t?a.add(Number(e.id)):a.delete(Number(e.id)),Array.from(a)})}})}),(0,a.jsx)(b.nA,{children:e.name}),(0,a.jsx)(b.nA,{children:e.client_name||"―"})]},e.id))})]})}),N.length>1&&(0,a.jsxs)("div",{className:"rounded-md border border-dashed bg-muted/40 px-3 py-2 text-xs text-muted-foreground",children:["選択した ",N.length," 件の案件へ順番に企業を追加します。案件ごとの結果は完了後のトーストで確認できます。"]}),(0,a.jsxs)(F.Es,{children:[(0,a.jsx)(i.$,{type:"button",variant:"outline",onClick:()=>s(!1),disabled:O,children:"キャンセル"}),(0,a.jsx)(i.$,{type:"button",onClick:X,disabled:O||0===N.length||0===V.length,children:O?"追加中...":"案件に追加 (".concat(V.length,"社)")})]})]}),(0,a.jsxs)(ee.av,{value:"new",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.J,{htmlFor:"new-project-name",children:"案件名"}),(0,a.jsx)(c.p,{id:"new-project-name",placeholder:"新規案件名を入力",value:k,onChange:e=>A(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.J,{htmlFor:"client-select",children:"クライアントを選択"}),(0,a.jsxs)(o.l6,{onValueChange:e=>S(Number(e)),value:(null==C?void 0:C.toString())||"",disabled:$,children:[(0,a.jsx)(o.bq,{id:"client-select",children:(0,a.jsx)(o.yv,{placeholder:$?"読み込み中...":"クライアントを選択"})}),(0,a.jsx)(o.gC,{className:"max-h-64",children:0===j.length?(0,a.jsx)("div",{className:"px-3 py-2 text-sm text-muted-foreground",children:"利用可能なクライアントがありません。"}):j.map(e=>(0,a.jsx)(o.eb,{value:String(e.id),children:e.name},e.id))})]})]}),(0,a.jsxs)(F.Es,{children:[(0,a.jsx)(i.$,{type:"button",variant:"outline",onClick:()=>s(!1),disabled:O,children:"キャンセル"}),(0,a.jsx)(i.$,{type:"button",onClick:W,disabled:O||!k.trim()||!C||0===V.length,children:O?"作成中...":"案件を作成して追加"})]})]})]})]})]})})]})})}function es(){let[e,t]=(0,n.useState)({}),[s,c]=(0,n.useState)({}),[d,o]=(0,n.useState)(1),[u,h]=(0,n.useState)(!1),[x,p]=(0,n.useState)(!1),[v,j]=(0,n.useState)([]),[f,b]=(0,n.useState)(!1),N=(0,l.useSearchParams)(),{user:w}=(0,Y.A)(),_=(0,n.useMemo)(()=>JSON.stringify(e)!==JSON.stringify(s),[e,s]),C=(0,n.useMemo)(()=>Object.values(s).some(e=>Array.isArray(e)?e.length>0:void 0!==e&&""!==e),[s]),{companies:S,pagination:A,isLoading:E,error:M,refetch:F}=(0,X.R)(s,d,100),{toast:I}=(0,Q.dj)(),L=(0,l.useRouter)(),R=(null==w?void 0:w.role)==="admin";(0,n.useEffect)(()=>{j(e=>e.filter(e=>S.some(t=>t.id===e)))},[S]);let V=(0,n.useMemo)(()=>new Set(v),[v]),J=(0,n.useMemo)(()=>S.filter(e=>V.has(e.id)),[S,V]);(0,n.useEffect)(()=>{(null==N?void 0:N.get("refresh"))==="true"&&(F(),window.history.replaceState(null,"","/companies"))},[N,F]);let D=(0,n.useCallback)((e,t)=>{j(s=>{let a=new Set(s);return t?a.add(e):a.delete(e),Array.from(a)})},[]),H=(0,n.useCallback)(e=>{e?j(S.map(e=>e.id)):j([])},[S]),B=(0,n.useCallback)(e=>{j([e.id]),b(!0)},[]),U=(0,n.useCallback)(e=>{b(!1),j([]);let t=e.reduce((e,t)=>{var s;return e+(null!==(s=t.addedCount)&&void 0!==s?s:0)},0),s=e.reduce((e,t)=>{var s,a;return e+(null!==(a=null===(s=t.errors)||void 0===s?void 0:s.length)&&void 0!==a?a:0)},0),a=1===e.length?e[0].projectName:"".concat(e.length,"件の案件");I({title:"案件に追加しました",description:s>0?"".concat(a," に ").concat(t,"社を追加。").concat(s,"件は除外されました。"):"".concat(a," に ").concat(t,"社を追加しました。")}),1===e.length&&e[0].addedCount>0&&L.push("/projects/".concat(e[0].projectId)),F()},[F,L,I]),q=async()=>{p(!0);try{var e;let t=(e=S,[O.map(e=>P[e]).join(","),...e.map(e=>O.map(t=>{var s;let a=(null===(s=e[t])||void 0===s?void 0:s.toString())||"";return("employee_count"===t||"revenue"===t)&&(a=a.toString()),(a.includes(",")||a.includes('"')||a.includes("\n"))&&(a='"'.concat(a.replace(/"/g,'""'),'"')),a}).join(","))].join("\n")),s=new Date().toISOString().split("T")[0];T(t,"companies-export-".concat(s,".csv"))}catch(e){}finally{p(!1)}},ee=async e=>{try{for(let t of e)if(!(await W.uE.post(W.i3.ENDPOINTS.COMPANIES,t)).ok)throw Error("Failed to import: ".concat(t.name));await F()}catch(e){throw e}};return(0,a.jsx)(r.MainLayout,{children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"flex items-center gap-4",children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(K,{className:"h-6 w-6 text-gray-600"}),(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"企業データベース管理"}),(0,a.jsx)(m.E,{variant:"secondary",children:"管理画面"})]}),(0,a.jsx)("p",{className:"text-muted-foreground mt-1",children:"営業対象企業のマスターデータを管理・メンテナンス"})]})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[R&&(0,a.jsxs)(i.$,{variant:"outline",onClick:q,disabled:x,children:[(0,a.jsx)(G.A,{className:"h-4 w-4 mr-2"}),x?"エクスポート中...":"CSV エクスポート"]}),(0,a.jsx)(i.$,{variant:"outline",disabled:0===S.length,onClick:()=>j(S.map(e=>e.id)),children:"表示中を全選択"}),(0,a.jsx)(i.$,{variant:"outline",disabled:0===v.length,onClick:()=>j([]),children:"選択を解除"}),(0,a.jsxs)(i.$,{variant:"default",disabled:0===v.length,onClick:()=>b(!0),children:[(0,a.jsx)(k.A,{className:"h-4 w-4 mr-2"}),"案件に追加"]}),(0,a.jsxs)(i.$,{variant:"outline",onClick:()=>h(!0),children:[(0,a.jsx)(z.A,{className:"h-4 w-4 mr-2"}),"CSV インポート"]}),(0,a.jsx)(i.$,{asChild:!0,children:(0,a.jsxs)(y(),{href:"/companies/new",children:[(0,a.jsx)(k.A,{className:"h-4 w-4 mr-2"}),"企業追加"]})})]})]}),(0,a.jsx)(g,{filters:e,onFiltersChange:e=>{t(e)},onClearFilters:()=>{t({}),c({}),o(1)},onApplyFilters:()=>{c(JSON.parse(JSON.stringify(e))),o(1)},filtersChanged:_,hasAppliedFilters:C}),M&&(0,a.jsx)("div",{className:"bg-destructive/10 border border-destructive/20 text-destructive px-4 py-3 rounded-md",children:M}),(0,a.jsx)($,{companies:S,isLoading:E,onRefresh:F,selectable:!0,selectedIds:v,onSelectChange:D,onSelectAllChange:H,onAddToProject:B}),A&&A.total_pages>1&&(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[A.total,"件中 ",(d-1)*A.limit+1,"件目から"," ",Math.min(d*A.limit,A.total),"件目を表示"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(i.$,{variant:"outline",size:"sm",onClick:()=>o(d-1),disabled:1===d,children:"前へ"}),(0,a.jsxs)("span",{className:"text-sm",children:[d," / ",A.total_pages," ページ"]}),(0,a.jsx)(i.$,{variant:"outline",size:"sm",onClick:()=>o(d+1),disabled:d===A.total_pages,children:"次へ"})]})]}),(0,a.jsx)(Z,{open:u,onOpenChange:h,onImport:ee}),(0,a.jsx)(et,{open:f,onOpenChange:e=>{b(e),e||j([])},companies:J,onCompleted:U})]})})}function ea(){return(0,a.jsx)(n.Suspense,{fallback:(0,a.jsx)("div",{className:"flex items-center justify-center h-screen",children:"Loading..."}),children:(0,a.jsx)(es,{})})}},3518:(e,t,s)=>{"use strict";s.d(t,{R:()=>i});var a=s(2115),n=s(98),l=s(1056),r=s(7259);function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,[i,c]=(0,a.useState)([]),[d,o]=(0,a.useState)({page:1,limit:100,total:0,total_pages:0}),[u,m]=(0,a.useState)(!0),[h,x]=(0,a.useState)(null),p=async()=>{if(!l.authService.isAuthenticated()){m(!1),window.location.href="/login";return}m(!0),x(null);try{let a=[],l=t,i=!0;for(;i&&a.length<100;){let c=new URLSearchParams({page:l.toString(),page_size:s.toString()});e.search&&c.append("search",e.search),e.industry&&c.append("industry",e.industry),e.employee_min&&c.append("employee_min",e.employee_min.toString()),e.employee_max&&c.append("employee_max",e.employee_max.toString()),e.revenue_min&&c.append("revenue_min",e.revenue_min.toString()),e.revenue_max&&c.append("revenue_max",e.revenue_max.toString()),e.prefecture&&c.append("prefecture",e.prefecture),e.established_year_min&&c.append("established_year_min",e.established_year_min.toString()),e.established_year_max&&c.append("established_year_max",e.established_year_max.toString()),void 0!==e.has_facebook&&c.append("has_facebook",e.has_facebook.toString()),void 0!==e.exclude_ng&&c.append("exclude_ng",e.exclude_ng.toString()),e.project_id&&c.append("project_id",e.project_id.toString());let d=await n.uE.get("".concat(r.i3.ENDPOINTS.COMPANIES,"?").concat(c.toString()));if(d&&d.results&&Array.isArray(d.results)){let e=d.results,n=new Set(a.map(e=>e.id)),r=e.filter(e=>!n.has(e.id));if(a=[...a,...r],i=!!d.next&&d.results.length>0,++l===t+1){let e=Math.ceil(d.count/s);o({page:t,limit:s,total:d.count,total_pages:e})}}else i=!1;if(l>t+10)break}c(a)}catch(e){x(e instanceof Error?e.message:"企業データの取得に失敗しました"),c([]),o({page:1,limit:100,total:0,total_pages:0})}finally{m(!1)}};return(0,a.useEffect)(()=>{p()},[JSON.stringify(e),t,s]),{companies:i,pagination:d,isLoading:u,error:h,refetch:p,bulkAddCompaniesToProjects:(e,t)=>n.uE.post(r.i3.ENDPOINTS.COMPANY_BULK_ADD_TO_PROJECTS,{company_ids:e,project_ids:t})}}},3786:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]])},5139:(e,t,s)=>{"use strict";s.d(t,{S:()=>i});var a=s(5155);s(2115);var n=s(8030),l=s(5196),r=s(3999);function i(e){let{className:t,...s}=e;return(0,a.jsx)(n.bL,{"data-slot":"checkbox",className:(0,r.cn)("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...s,children:(0,a.jsx)(n.C1,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:(0,a.jsx)(l.A,{className:"size-3.5"})})})}},6193:(e,t,s)=>{"use strict";s.d(t,{k:()=>b});var a=s(5155),n=s(2115);s(7650);var l=s(6634),r=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let s=(0,l.TL)(`Primitive.${t}`),r=n.forwardRef((e,n)=>{let{asChild:l,...r}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,a.jsx)(l?s:t,{...r,ref:n})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{}),i="Progress",[c,d]=function(e,t=[]){let s=[],l=()=>{let t=s.map(e=>n.createContext(e));return function(s){let a=s?.[e]||t;return n.useMemo(()=>({[`__scope${e}`]:{...s,[e]:a}}),[s,a])}};return l.scopeName=e,[function(t,l){let r=n.createContext(l),i=s.length;s=[...s,l];let c=t=>{let{scope:s,children:l,...c}=t,d=s?.[e]?.[i]||r,o=n.useMemo(()=>c,Object.values(c));return(0,a.jsx)(d.Provider,{value:o,children:l})};return c.displayName=t+"Provider",[c,function(s,a){let c=a?.[e]?.[i]||r,d=n.useContext(c);if(d)return d;if(void 0!==l)return l;throw Error(`\`${s}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let s=()=>{let s=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let a=s.reduce((t,{useScope:s,scopeName:a})=>{let n=s(e)[`__scope${a}`];return{...t,...n}},{});return n.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return s.scopeName=t.scopeName,s}(l,...t)]}(i),[o,u]=c(i),m=n.forwardRef((e,t)=>{let{__scopeProgress:s,value:n=null,max:l,getValueLabel:i=p,...c}=e;(l||0===l)&&g(l);let d=g(l)?l:100;null!==n&&f(n,d);let u=f(n,d)?n:null,m=j(u)?i(u,d):void 0;return(0,a.jsx)(o,{scope:s,value:u,max:d,children:(0,a.jsx)(r.div,{"aria-valuemax":d,"aria-valuemin":0,"aria-valuenow":j(u)?u:void 0,"aria-valuetext":m,role:"progressbar","data-state":v(u,d),"data-value":null!=u?u:void 0,"data-max":d,...c,ref:t})})});m.displayName=i;var h="ProgressIndicator",x=n.forwardRef((e,t)=>{var s;let{__scopeProgress:n,...l}=e,i=u(h,n);return(0,a.jsx)(r.div,{"data-state":v(i.value,i.max),"data-value":null!==(s=i.value)&&void 0!==s?s:void 0,"data-max":i.max,...l,ref:t})});function p(e,t){return"".concat(Math.round(e/t*100),"%")}function v(e,t){return null==e?"indeterminate":e===t?"complete":"loading"}function j(e){return"number"==typeof e}function g(e){return j(e)&&!isNaN(e)&&e>0}function f(e,t){return j(e)&&!isNaN(e)&&e<=t&&e>=0}x.displayName=h;var y=s(3999);function b(e){let{className:t,value:s,...n}=e;return(0,a.jsx)(m,{"data-slot":"progress",className:(0,y.cn)("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",t),...n,children:(0,a.jsx)(x,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:"translateX(-".concat(100-(s||0),"%)")}})})}},7434:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},9643:(e,t,s)=>{Promise.resolve().then(s.bind(s,1790))},9869:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[8823,7715,7501,2717,2286,85,6358,3953,5646,7869,5867,8441,1684,7358],()=>t(9643)),_N_E=e.O()}]);